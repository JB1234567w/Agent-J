/**\n * Deep Research Panel Component\n * UI for initiating and displaying deep research results\n */\n\nimport React, { useState } from \"react\";\nimport { useDeepResearch } from \"../_core/hooks/useDeepResearch\";\nimport { Button } from \"./ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"./ui/card\";\nimport { Input } from \"./ui/input\";\nimport { Badge } from \"./ui/badge\";\nimport { Progress } from \"./ui/progress\";\nimport { Loader2, Search, CheckCircle2, AlertCircle } from \"lucide-react\";\n\ninterface DeepResearchPanelProps {\n  sessionId: number;\n  onResearchComplete?: (report: string) => void;\n}\n\nexport function DeepResearchPanel({\n  sessionId,\n  onResearchComplete,\n}: DeepResearchPanelProps) {\n  const [query, setQuery] = useState(\"\");\n  const {\n    isLoading,\n    progress,\n    report,\n    findingsCount,\n    citationsCount,\n    error,\n    executionTime,\n    startResearch,\n    resetState,\n  } = useDeepResearch();\n\n  const handleStartResearch = async () => {\n    if (!query.trim()) return;\n\n    try {\n      const result = await startResearch(sessionId, query);\n      if (onResearchComplete) {\n        onResearchComplete(result.report);\n      }\n    } catch (err) {\n      console.error(\"Research failed:\", err);\n    }\n  };\n\n  const handleReset = () => {\n    resetState();\n    setQuery(\"\");\n  };\n\n  return (\n    <div className=\"w-full space-y-4\">\n      {/* Search Input */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Search className=\"h-5 w-5\" />\n            Deep Research\n          </CardTitle>\n          <CardDescription>\n            Conduct comprehensive research using multiple AI agents\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex gap-2\">\n            <Input\n              placeholder=\"Enter your research query...\"\n              value={query}\n              onChange={(e) => setQuery(e.target.value)}\n              disabled={isLoading}\n              onKeyPress={(e) => {\n                if (e.key === \"Enter\" && !isLoading) {\n                  handleStartResearch();\n                }\n              }}\n            />\n            <Button\n              onClick={handleStartResearch}\n              disabled={isLoading || !query.trim()}\n              className=\"gap-2\"\n            >\n              {isLoading ? (\n                <>\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                  Researching...\n                </>\n              ) : (\n                <>Research</>\n              )}\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Progress Indicator */}\n      {isLoading && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-sm\">Research in Progress</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-2\">\n            <Progress value={progress} className=\"h-2\" />\n            <p className=\"text-xs text-muted-foreground\">{progress}% complete</p>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Error Display */}\n      {error && (\n        <Card className=\"border-red-200 bg-red-50\">\n          <CardContent className=\"flex items-start gap-3 pt-6\">\n            <AlertCircle className=\"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5\" />\n            <div>\n              <p className=\"font-medium text-red-900\">Research Failed</p>\n              <p className=\"text-sm text-red-700\">{error}</p>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Results Display */}\n      {report && (\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-start justify-between\">\n              <div>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\n                  Research Complete\n                </CardTitle>\n                <CardDescription>Deep research results</CardDescription>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" onClick={handleReset}>\n                New Research\n              </Button>\n            </div>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {/* Stats */}\n            <div className=\"grid grid-cols-3 gap-4\">\n              <div className=\"space-y-1\">\n                <p className=\"text-xs text-muted-foreground\">Findings</p>\n                <Badge variant=\"secondary\" className=\"text-base\">\n                  {findingsCount}\n                </Badge>\n              </div>\n              <div className=\"space-y-1\">\n                <p className=\"text-xs text-muted-foreground\">Citations</p>\n                <Badge variant=\"secondary\" className=\"text-base\">\n                  {citationsCount}\n                </Badge>\n              </div>\n              <div className=\"space-y-1\">\n                <p className=\"text-xs text-muted-foreground\">Time</p>\n                <Badge variant=\"secondary\" className=\"text-base\">\n                  {executionTime ? `${(executionTime / 1000).toFixed(1)}s` : \"â€”\"}\n                </Badge>\n              </div>\n            </div>\n\n            {/* Report */}\n            <div className=\"space-y-2\">\n              <p className=\"text-sm font-medium\">Research Report</p>\n              <div className=\"bg-muted p-4 rounded-lg max-h-96 overflow-y-auto\">\n                <p className=\"text-sm whitespace-pre-wrap text-muted-foreground\">\n                  {report}\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n
